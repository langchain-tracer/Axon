{"version":3,"file":"index.mjs","sources":["../../../node_modules/decamelize/index.js","../../../node_modules/camelcase/index.js","../../../node_modules/@langchain/core/dist/load/map_keys.js","../../../node_modules/@langchain/core/dist/load/serializable.js","../../../node_modules/@langchain/core/dist/utils/env.js","../../../node_modules/@langchain/core/dist/callbacks/base.js","../src/client.ts","../src/serializer.ts","../src/callback.ts","../src/index.ts"],"sourcesContent":["'use strict';\nmodule.exports = function (str, sep) {\n\tif (typeof str !== 'string') {\n\t\tthrow new TypeError('Expected a string');\n\t}\n\n\tsep = typeof sep === 'undefined' ? '_' : sep;\n\n\treturn str\n\t\t.replace(/([a-z\\d])([A-Z])/g, '$1' + sep + '$2')\n\t\t.replace(/([A-Z]+)([A-Z][a-z\\d]+)/g, '$1' + sep + '$2')\n\t\t.toLowerCase();\n};\n","'use strict';\n\nconst UPPERCASE = /[\\p{Lu}]/u;\nconst LOWERCASE = /[\\p{Ll}]/u;\nconst LEADING_CAPITAL = /^[\\p{Lu}](?![\\p{Lu}])/gu;\nconst IDENTIFIER = /([\\p{Alpha}\\p{N}_]|$)/u;\nconst SEPARATORS = /[_.\\- ]+/;\n\nconst LEADING_SEPARATORS = new RegExp('^' + SEPARATORS.source);\nconst SEPARATORS_AND_IDENTIFIER = new RegExp(SEPARATORS.source + IDENTIFIER.source, 'gu');\nconst NUMBERS_AND_IDENTIFIER = new RegExp('\\\\d+' + IDENTIFIER.source, 'gu');\n\nconst preserveCamelCase = (string, toLowerCase, toUpperCase) => {\n\tlet isLastCharLower = false;\n\tlet isLastCharUpper = false;\n\tlet isLastLastCharUpper = false;\n\n\tfor (let i = 0; i < string.length; i++) {\n\t\tconst character = string[i];\n\n\t\tif (isLastCharLower && UPPERCASE.test(character)) {\n\t\t\tstring = string.slice(0, i) + '-' + string.slice(i);\n\t\t\tisLastCharLower = false;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = true;\n\t\t\ti++;\n\t\t} else if (isLastCharUpper && isLastLastCharUpper && LOWERCASE.test(character)) {\n\t\t\tstring = string.slice(0, i - 1) + '-' + string.slice(i - 1);\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = false;\n\t\t\tisLastCharLower = true;\n\t\t} else {\n\t\t\tisLastCharLower = toLowerCase(character) === character && toUpperCase(character) !== character;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = toUpperCase(character) === character && toLowerCase(character) !== character;\n\t\t}\n\t}\n\n\treturn string;\n};\n\nconst preserveConsecutiveUppercase = (input, toLowerCase) => {\n\tLEADING_CAPITAL.lastIndex = 0;\n\n\treturn input.replace(LEADING_CAPITAL, m1 => toLowerCase(m1));\n};\n\nconst postProcess = (input, toUpperCase) => {\n\tSEPARATORS_AND_IDENTIFIER.lastIndex = 0;\n\tNUMBERS_AND_IDENTIFIER.lastIndex = 0;\n\n\treturn input.replace(SEPARATORS_AND_IDENTIFIER, (_, identifier) => toUpperCase(identifier))\n\t\t.replace(NUMBERS_AND_IDENTIFIER, m => toUpperCase(m));\n};\n\nconst camelCase = (input, options) => {\n\tif (!(typeof input === 'string' || Array.isArray(input))) {\n\t\tthrow new TypeError('Expected the input to be `string | string[]`');\n\t}\n\n\toptions = {\n\t\tpascalCase: false,\n\t\tpreserveConsecutiveUppercase: false,\n\t\t...options\n\t};\n\n\tif (Array.isArray(input)) {\n\t\tinput = input.map(x => x.trim())\n\t\t\t.filter(x => x.length)\n\t\t\t.join('-');\n\t} else {\n\t\tinput = input.trim();\n\t}\n\n\tif (input.length === 0) {\n\t\treturn '';\n\t}\n\n\tconst toLowerCase = options.locale === false ?\n\t\tstring => string.toLowerCase() :\n\t\tstring => string.toLocaleLowerCase(options.locale);\n\tconst toUpperCase = options.locale === false ?\n\t\tstring => string.toUpperCase() :\n\t\tstring => string.toLocaleUpperCase(options.locale);\n\n\tif (input.length === 1) {\n\t\treturn options.pascalCase ? toUpperCase(input) : toLowerCase(input);\n\t}\n\n\tconst hasUpperCase = input !== toLowerCase(input);\n\n\tif (hasUpperCase) {\n\t\tinput = preserveCamelCase(input, toLowerCase, toUpperCase);\n\t}\n\n\tinput = input.replace(LEADING_SEPARATORS, '');\n\n\tif (options.preserveConsecutiveUppercase) {\n\t\tinput = preserveConsecutiveUppercase(input, toLowerCase);\n\t} else {\n\t\tinput = toLowerCase(input);\n\t}\n\n\tif (options.pascalCase) {\n\t\tinput = toUpperCase(input.charAt(0)) + input.slice(1);\n\t}\n\n\treturn postProcess(input, toUpperCase);\n};\n\nmodule.exports = camelCase;\n// TODO: Remove this for the next major release\nmodule.exports.default = camelCase;\n","import snakeCase from \"decamelize\";\nimport camelCase from \"camelcase\";\nexport function keyToJson(key, map) {\n    return map?.[key] || snakeCase(key);\n}\nexport function keyFromJson(key, map) {\n    return map?.[key] || camelCase(key);\n}\nexport function mapKeys(fields, mapper, map) {\n    const mapped = {};\n    for (const key in fields) {\n        if (Object.hasOwn(fields, key)) {\n            mapped[mapper(key, map)] = fields[key];\n        }\n    }\n    return mapped;\n}\n","import { keyToJson, mapKeys } from \"./map_keys.js\";\nfunction shallowCopy(obj) {\n    return Array.isArray(obj) ? [...obj] : { ...obj };\n}\nfunction replaceSecrets(root, secretsMap) {\n    const result = shallowCopy(root);\n    for (const [path, secretId] of Object.entries(secretsMap)) {\n        const [last, ...partsReverse] = path.split(\".\").reverse();\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        let current = result;\n        for (const part of partsReverse.reverse()) {\n            if (current[part] === undefined) {\n                break;\n            }\n            current[part] = shallowCopy(current[part]);\n            current = current[part];\n        }\n        if (current[last] !== undefined) {\n            current[last] = {\n                lc: 1,\n                type: \"secret\",\n                id: [secretId],\n            };\n        }\n    }\n    return result;\n}\n/**\n * Get a unique name for the module, rather than parent class implementations.\n * Should not be subclassed, subclass lc_name above instead.\n */\nexport function get_lc_unique_name(\n// eslint-disable-next-line @typescript-eslint/no-use-before-define\nserializableClass) {\n    // \"super\" here would refer to the parent class of Serializable,\n    // when we want the parent class of the module actually calling this method.\n    const parentClass = Object.getPrototypeOf(serializableClass);\n    const lcNameIsSubclassed = typeof serializableClass.lc_name === \"function\" &&\n        (typeof parentClass.lc_name !== \"function\" ||\n            serializableClass.lc_name() !== parentClass.lc_name());\n    if (lcNameIsSubclassed) {\n        return serializableClass.lc_name();\n    }\n    else {\n        return serializableClass.name;\n    }\n}\nexport class Serializable {\n    /**\n     * The name of the serializable. Override to provide an alias or\n     * to preserve the serialized module name in minified environments.\n     *\n     * Implemented as a static method to support loading logic.\n     */\n    static lc_name() {\n        return this.name;\n    }\n    /**\n     * The final serialized identifier for the module.\n     */\n    get lc_id() {\n        return [\n            ...this.lc_namespace,\n            get_lc_unique_name(this.constructor),\n        ];\n    }\n    /**\n     * A map of secrets, which will be omitted from serialization.\n     * Keys are paths to the secret in constructor args, e.g. \"foo.bar.baz\".\n     * Values are the secret ids, which will be used when deserializing.\n     */\n    get lc_secrets() {\n        return undefined;\n    }\n    /**\n     * A map of additional attributes to merge with constructor args.\n     * Keys are the attribute names, e.g. \"foo\".\n     * Values are the attribute values, which will be serialized.\n     * These attributes need to be accepted by the constructor as arguments.\n     */\n    get lc_attributes() {\n        return undefined;\n    }\n    /**\n     * A map of aliases for constructor args.\n     * Keys are the attribute names, e.g. \"foo\".\n     * Values are the alias that will replace the key in serialization.\n     * This is used to eg. make argument names match Python.\n     */\n    get lc_aliases() {\n        return undefined;\n    }\n    constructor(kwargs, ..._args) {\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"lc_kwargs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.lc_kwargs = kwargs || {};\n    }\n    toJSON() {\n        if (!this.lc_serializable) {\n            return this.toJSONNotImplemented();\n        }\n        if (\n        // eslint-disable-next-line no-instanceof/no-instanceof\n        this.lc_kwargs instanceof Serializable ||\n            typeof this.lc_kwargs !== \"object\" ||\n            Array.isArray(this.lc_kwargs)) {\n            // We do not support serialization of classes with arg not a POJO\n            // I'm aware the check above isn't as strict as it could be\n            return this.toJSONNotImplemented();\n        }\n        const aliases = {};\n        const secrets = {};\n        const kwargs = Object.keys(this.lc_kwargs).reduce((acc, key) => {\n            acc[key] = key in this ? this[key] : this.lc_kwargs[key];\n            return acc;\n        }, {});\n        // get secrets, attributes and aliases from all superclasses\n        for (\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        let current = Object.getPrototypeOf(this); current; current = Object.getPrototypeOf(current)) {\n            Object.assign(aliases, Reflect.get(current, \"lc_aliases\", this));\n            Object.assign(secrets, Reflect.get(current, \"lc_secrets\", this));\n            Object.assign(kwargs, Reflect.get(current, \"lc_attributes\", this));\n        }\n        // include all secrets used, even if not in kwargs,\n        // will be replaced with sentinel value in replaceSecrets\n        Object.keys(secrets).forEach((keyPath) => {\n            // eslint-disable-next-line @typescript-eslint/no-this-alias, @typescript-eslint/no-explicit-any\n            let read = this;\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            let write = kwargs;\n            const [last, ...partsReverse] = keyPath.split(\".\").reverse();\n            for (const key of partsReverse.reverse()) {\n                if (!(key in read) || read[key] === undefined)\n                    return;\n                if (!(key in write) || write[key] === undefined) {\n                    if (typeof read[key] === \"object\" && read[key] != null) {\n                        write[key] = {};\n                    }\n                    else if (Array.isArray(read[key])) {\n                        write[key] = [];\n                    }\n                }\n                read = read[key];\n                write = write[key];\n            }\n            if (last in read && read[last] !== undefined) {\n                write[last] = write[last] || read[last];\n            }\n        });\n        return {\n            lc: 1,\n            type: \"constructor\",\n            id: this.lc_id,\n            kwargs: mapKeys(Object.keys(secrets).length ? replaceSecrets(kwargs, secrets) : kwargs, keyToJson, aliases),\n        };\n    }\n    toJSONNotImplemented() {\n        return {\n            lc: 1,\n            type: \"not_implemented\",\n            id: this.lc_id,\n        };\n    }\n}\n","export const isBrowser = () => typeof window !== \"undefined\" && typeof window.document !== \"undefined\";\nexport const isWebWorker = () => typeof globalThis === \"object\" &&\n    globalThis.constructor &&\n    globalThis.constructor.name === \"DedicatedWorkerGlobalScope\";\nexport const isJsDom = () => (typeof window !== \"undefined\" && window.name === \"nodejs\") ||\n    (typeof navigator !== \"undefined\" &&\n        (navigator.userAgent.includes(\"Node.js\") ||\n            navigator.userAgent.includes(\"jsdom\")));\n// Supabase Edge Function provides a `Deno` global object\n// without `version` property\nexport const isDeno = () => typeof Deno !== \"undefined\";\n// Mark not-as-node if in Supabase Edge Function\nexport const isNode = () => typeof process !== \"undefined\" &&\n    typeof process.versions !== \"undefined\" &&\n    typeof process.versions.node !== \"undefined\" &&\n    !isDeno();\nexport const getEnv = () => {\n    let env;\n    if (isBrowser()) {\n        env = \"browser\";\n    }\n    else if (isNode()) {\n        env = \"node\";\n    }\n    else if (isWebWorker()) {\n        env = \"webworker\";\n    }\n    else if (isJsDom()) {\n        env = \"jsdom\";\n    }\n    else if (isDeno()) {\n        env = \"deno\";\n    }\n    else {\n        env = \"other\";\n    }\n    return env;\n};\nlet runtimeEnvironment;\nexport async function getRuntimeEnvironment() {\n    if (runtimeEnvironment === undefined) {\n        const env = getEnv();\n        runtimeEnvironment = {\n            library: \"langchain-js\",\n            runtime: env,\n        };\n    }\n    return runtimeEnvironment;\n}\nexport function getEnvironmentVariable(name) {\n    // Certain Deno setups will throw an error if you try to access environment variables\n    // https://github.com/langchain-ai/langchainjs/issues/1412\n    try {\n        return typeof process !== \"undefined\"\n            ? // eslint-disable-next-line no-process-env\n                process.env?.[name]\n            : undefined;\n    }\n    catch (e) {\n        return undefined;\n    }\n}\n","import * as uuid from \"uuid\";\nimport { Serializable, get_lc_unique_name, } from \"../load/serializable.js\";\nimport { getEnvironmentVariable } from \"../utils/env.js\";\n/**\n * Abstract class that provides a set of optional methods that can be\n * overridden in derived classes to handle various events during the\n * execution of a LangChain application.\n */\nclass BaseCallbackHandlerMethodsClass {\n}\n/**\n * Abstract base class for creating callback handlers in the LangChain\n * framework. It provides a set of optional methods that can be overridden\n * in derived classes to handle various events during the execution of a\n * LangChain application.\n */\nexport class BaseCallbackHandler extends BaseCallbackHandlerMethodsClass {\n    get lc_namespace() {\n        return [\"langchain_core\", \"callbacks\", this.name];\n    }\n    get lc_secrets() {\n        return undefined;\n    }\n    get lc_attributes() {\n        return undefined;\n    }\n    get lc_aliases() {\n        return undefined;\n    }\n    /**\n     * The name of the serializable. Override to provide an alias or\n     * to preserve the serialized module name in minified environments.\n     *\n     * Implemented as a static method to support loading logic.\n     */\n    static lc_name() {\n        return this.name;\n    }\n    /**\n     * The final serialized identifier for the module.\n     */\n    get lc_id() {\n        return [\n            ...this.lc_namespace,\n            get_lc_unique_name(this.constructor),\n        ];\n    }\n    constructor(input) {\n        super();\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"lc_kwargs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"ignoreLLM\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"ignoreChain\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"ignoreAgent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"ignoreRetriever\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"ignoreCustomEvent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"raiseError\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"awaitHandlers\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: getEnvironmentVariable(\"LANGCHAIN_CALLBACKS_BACKGROUND\") !== \"true\"\n        });\n        this.lc_kwargs = input || {};\n        if (input) {\n            this.ignoreLLM = input.ignoreLLM ?? this.ignoreLLM;\n            this.ignoreChain = input.ignoreChain ?? this.ignoreChain;\n            this.ignoreAgent = input.ignoreAgent ?? this.ignoreAgent;\n            this.ignoreRetriever = input.ignoreRetriever ?? this.ignoreRetriever;\n            this.ignoreCustomEvent =\n                input.ignoreCustomEvent ?? this.ignoreCustomEvent;\n            this.raiseError = input.raiseError ?? this.raiseError;\n            this.awaitHandlers =\n                this.raiseError || (input._awaitHandler ?? this.awaitHandlers);\n        }\n    }\n    copy() {\n        return new this.constructor(this);\n    }\n    toJSON() {\n        return Serializable.prototype.toJSON.call(this);\n    }\n    toJSONNotImplemented() {\n        return Serializable.prototype.toJSONNotImplemented.call(this);\n    }\n    static fromMethods(methods) {\n        class Handler extends BaseCallbackHandler {\n            constructor() {\n                super();\n                Object.defineProperty(this, \"name\", {\n                    enumerable: true,\n                    configurable: true,\n                    writable: true,\n                    value: uuid.v4()\n                });\n                Object.assign(this, methods);\n            }\n        }\n        return new Handler();\n    }\n}\n","/**\n * WebSocket client for sending trace events to backend\n */\n\nimport { io, Socket } from \"socket.io-client\";\nimport { TraceConfig, TraceEvent } from \"./types\";\n\nexport class TraceClient {\n  private socket: Socket | null = null;\n  private config: TraceConfig;\n  private connected: boolean = false;\n  private eventQueue: TraceEvent[] = [];\n  private reconnectAttempts: number = 0;\n  private maxReconnectAttempts: number = 5;\n  private batchTimer: NodeJS.Timeout | null = null;\n\n  constructor(config: Partial<TraceConfig>) {\n    this.config = {\n      batchInterval: 100,\n      batchSize: 50,\n      debug: false,\n      projectName: \"default\",\n      endpoint: \"http://localhost:8000\",\n      ...config\n    } as TraceConfig;\n\n    this.connect();\n  }\n\n  /**\n   * Connect to WebSocket server\n   */\n  private connect(): void {\n    try {\n      this.socket = io(this.config.endpoint, {\n        auth: {\n          apiKey: this.config.apiKey,\n          projectName: this.config.projectName\n        },\n        transports: [\"websocket\"],\n        reconnection: true,\n        reconnectionAttempts: this.maxReconnectAttempts,\n        reconnectionDelay: 1000\n      });\n\n      this.socket.on(\"connect\", () => {\n        this.connected = true;\n        this.reconnectAttempts = 0;\n        this.log(\"‚úÖ Connected to trace backend\");\n\n        // Flush queued events\n        this.flushQueue();\n      });\n\n      this.socket.on(\"disconnect\", () => {\n        this.connected = false;\n        this.log(\"‚ö†Ô∏è  Disconnected from trace backend\");\n      });\n\n      this.socket.on(\"connect_error\", (error) => {\n        this.reconnectAttempts++;\n        this.log(`‚ùå Connection error: ${error.message}`);\n\n        if (this.reconnectAttempts >= this.maxReconnectAttempts) {\n          this.log(\n            \"‚ö†Ô∏è  Max reconnection attempts reached. Events will be queued.\"\n          );\n        }\n      });\n\n      this.socket.on(\"error\", (error) => {\n        this.log(`‚ùå Socket error: ${error}`);\n      });\n\n      // Start batch timer\n      this.startBatchTimer();\n    } catch (error) {\n      this.log(`‚ùå Failed to create socket: ${error}`);\n    }\n  }\n\n  /**\n   * Send event to backend\n   */\n  public async sendEvent(event: TraceEvent): Promise<void> {\n    this.eventQueue.push(event);\n\n    // Send immediately if batch size reached\n    if (this.eventQueue.length >= this.config.batchSize!) {\n      this.flushQueue();\n    }\n\n    // Return immediately - actual sending happens asynchronously\n    return Promise.resolve();\n  }\n\n  /**\n   * Start batch timer to flush events periodically\n   */\n  private startBatchTimer(): void {\n    if (this.batchTimer) {\n      clearInterval(this.batchTimer);\n    }\n\n    this.batchTimer = setInterval(() => {\n      if (this.eventQueue.length > 0) {\n        this.flushQueue();\n      }\n    }, this.config.batchInterval);\n  }\n\n  /**\n   * Flush queued events to server\n   */\n  private flushQueue(): void {\n    if (this.eventQueue.length === 0) return;\n\n    const events = [...this.eventQueue];\n    this.eventQueue = [];\n\n    if (this.connected && this.socket) {\n      this.socket.emit(\"trace_events\", events);\n      this.log(`üì§ Sent ${events.length} events`);\n    } else {\n      // Re-queue if not connected\n      this.eventQueue.unshift(...events);\n      this.log(`‚è≥ Queued ${events.length} events (not connected)`);\n    }\n  }\n\n  /**\n   * Disconnect and cleanup\n   */\n  public disconnect(): void {\n    // Flush remaining events\n    this.flushQueue();\n\n    if (this.batchTimer) {\n      clearInterval(this.batchTimer);\n      this.batchTimer = null;\n    }\n\n    if (this.socket) {\n      this.socket.disconnect();\n      this.socket = null;\n    }\n\n    this.connected = false;\n  }\n\n  /**\n   * Check if connected\n   */\n  public isConnected(): boolean {\n    return this.connected;\n  }\n\n  /**\n   * Get queue size\n   */\n  public getQueueSize(): number {\n    return this.eventQueue.length;\n  }\n\n  /**\n   * Debug logging\n   */\n  private log(message: string): void {\n    if (this.config.debug) {\n      console.log(`[AgentTrace] ${message}`);\n    }\n  }\n}\n","/**\n * Serialize LangChain data for transmission\n */\n\nimport { LLMResult } from \"@langchain/core/outputs\";\nimport { Serialized } from \"@langchain/core/load/serializable\";\n\nexport class EventSerializer {\n  /**\n   * Serialize LLM result\n   */\n  static serializeLLMResult(result: LLMResult): {\n    response: string;\n    tokens: { prompt: number; completion: number; total: number };\n  } {\n    const generations = result.generations[0];\n    const response = generations?.[0]?.text || \"\";\n\n    const tokenUsage = result.llmOutput?.tokenUsage || {};\n    const tokens = {\n      prompt: tokenUsage.promptTokens || 0,\n      completion: tokenUsage.completionTokens || 0,\n      total: tokenUsage.totalTokens || 0\n    };\n\n    return { response, tokens };\n  }\n\n  /**\n   * Serialize serialized object (model info, etc)\n   */\n  static serializeSerialized(serialized: Serialized): {\n    type: string;\n    name: string;\n    params: Record<string, any>;\n  } {\n    return {\n      type: String(serialized.lc || \"unknown\"),\n      name: serialized.id?.[serialized.id.length - 1] || \"unknown\",\n      params: (\"kwargs\" in serialized ? serialized.kwargs : {}) || {}\n    };\n  }\n\n  /**\n   * Serialize tool input (can be string or object)\n   */\n  static serializeToolInput(\n    input: string | Record<string, any>\n  ): string | Record<string, any> {\n    if (typeof input === \"string\") {\n      return input;\n    }\n\n    try {\n      // Remove non-serializable properties\n      return JSON.parse(JSON.stringify(input));\n    } catch (error) {\n      return String(input);\n    }\n  }\n\n  /**\n   * Calculate cost based on tokens and model\n   */\n  static calculateCost(\n    model: string,\n    tokens: { prompt: number; completion: number; total: number }\n  ): number {\n    const pricing: Record<string, { input: number; output: number }> = {\n      \"gpt-4\": { input: 0.03, output: 0.06 },\n      \"gpt-4-turbo\": { input: 0.01, output: 0.03 },\n      \"gpt-3.5-turbo\": { input: 0.0015, output: 0.002 },\n      \"claude-3-opus\": { input: 0.015, output: 0.075 },\n      \"claude-3-sonnet\": { input: 0.003, output: 0.015 },\n      \"claude-3-haiku\": { input: 0.00025, output: 0.00125 }\n    };\n\n    const rates = pricing[model] || pricing[\"gpt-3.5-turbo\"];\n\n    return (\n      (tokens.prompt / 1000) * rates.input +\n      (tokens.completion / 1000) * rates.output\n    );\n  }\n\n  /**\n   * Extract model name from serialized data\n   */\n  static extractModelName(serialized: Serialized): string {\n    const params = (\"kwargs\" in serialized ? serialized.kwargs : {}) || {};\n    return params.model_name || params.model || \"unknown\";\n  }\n\n  /**\n   * Safely stringify error\n   */\n  static serializeError(error: Error): { message: string; stack?: string } {\n    return {\n      message: error.message,\n      stack: error.stack\n    };\n  }\n}\n","/**\n * LangChain callback handler for tracing agent execution\n */\n\nimport { BaseCallbackHandler } from \"@langchain/core/callbacks/base\";\nimport { LLMResult } from \"@langchain/core/outputs\";\nimport { Serialized } from \"@langchain/core/load/serializable\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { TraceClient } from \"./client\";\nimport { EventSerializer } from \"./serializer\";\nimport {\n  TraceConfig,\n  RunData,\n  LLMStartEvent,\n  LLMEndEvent,\n  ToolStartEvent,\n  ToolEndEvent,\n  ChainStartEvent,\n  ChainEndEvent,\n  ErrorEvent\n} from \"./types\";\n\nexport class TracingCallbackHandler extends BaseCallbackHandler {\n  name = \"agent_trace_handler\";\n\n  private client: TraceClient;\n  private traceId: string;\n  private runDataMap: Map<string, RunData> = new Map();\n  private config: TraceConfig;\n\n  constructor(config?: Partial<TraceConfig>) {\n    super();\n\n    this.config = {\n      endpoint: config?.endpoint || \"http://localhost:8000\",\n      projectName: config?.projectName || \"default\",\n      debug: config?.debug || false,\n      ...config\n    };\n\n    this.client = new TraceClient(this.config);\n    this.traceId = uuidv4();\n\n    if (this.config.debug) {\n      console.log(`[AgentTrace] Started trace: ${this.traceId}`);\n    }\n  }\n\n  /**\n   * Called when LLM starts running\n   */\n  async handleLLMStart(\n    llm: Serialized,\n    prompts: string[],\n    runId: string,\n    parentRunId?: string,\n    extraParams?: Record<string, any>,\n    tags?: string[],\n    metadata?: Record<string, any>\n  ): Promise<void> {\n    const serialized = EventSerializer.serializeSerialized(llm);\n    const model = EventSerializer.extractModelName(llm);\n\n    // Store run data\n    this.runDataMap.set(runId, {\n      runId,\n      parentRunId,\n      nodeType: \"llm\",\n      startTime: Date.now(),\n      status: \"running\",\n      data: {\n        model,\n        prompts,\n        serialized\n      }\n    });\n\n    // Send event\n    const event: LLMStartEvent = {\n      eventId: uuidv4(),\n      traceId: this.traceId,\n      runId,\n      parentRunId,\n      timestamp: Date.now(),\n      type: \"llm_start\",\n      model,\n      prompts,\n      invocationParams: extraParams,\n      metadata: {\n        ...this.config.metadata,\n        ...metadata,\n        tags\n      }\n    };\n\n    await this.client.sendEvent(event);\n  }\n\n  /**\n   * Called when LLM ends running\n   */\n  async handleLLMEnd(output: LLMResult, runId: string): Promise<void> {\n    const runData = this.runDataMap.get(runId);\n    if (!runData) {\n      console.error(`[AgentTrace] No run data found for ${runId}`);\n      return;\n    }\n\n    const endTime = Date.now();\n    const latency = endTime - runData.startTime;\n\n    // Serialize output\n    const { response, tokens } = EventSerializer.serializeLLMResult(output);\n    const cost = EventSerializer.calculateCost(runData.data.model, tokens);\n\n    // Update run data\n    runData.endTime = endTime;\n    runData.status = \"complete\";\n\n    // Send event\n    const event: LLMEndEvent = {\n      eventId: uuidv4(),\n      traceId: this.traceId,\n      runId,\n      parentRunId: runData.parentRunId,\n      timestamp: endTime,\n      type: \"llm_end\",\n      response,\n      tokens,\n      cost,\n      latency\n    };\n\n    await this.client.sendEvent(event);\n  }\n\n  /**\n   * Called when tool starts running\n   */\n  async handleToolStart(\n    tool: Serialized,\n    input: string,\n    runId: string,\n    parentRunId?: string,\n    tags?: string[],\n    metadata?: Record<string, any>\n  ): Promise<void> {\n    const serialized = EventSerializer.serializeSerialized(tool);\n    const toolName = serialized.name;\n\n    // Store run data\n    this.runDataMap.set(runId, {\n      runId,\n      parentRunId,\n      nodeType: \"tool\",\n      startTime: Date.now(),\n      status: \"running\",\n      data: {\n        toolName,\n        input\n      }\n    });\n\n    // Send event\n    const event: ToolStartEvent = {\n      eventId: uuidv4(),\n      traceId: this.traceId,\n      runId,\n      parentRunId,\n      timestamp: Date.now(),\n      type: \"tool_start\",\n      toolName,\n      input: EventSerializer.serializeToolInput(input),\n      metadata: {\n        ...this.config.metadata,\n        ...metadata,\n        tags\n      }\n    };\n\n    await this.client.sendEvent(event);\n  }\n\n  /**\n   * Called when tool ends running\n   */\n  async handleToolEnd(output: string, runId: string): Promise<void> {\n    const runData = this.runDataMap.get(runId);\n    if (!runData) {\n      console.error(`[AgentTrace] No run data found for ${runId}`);\n      return;\n    }\n\n    const endTime = Date.now();\n    const latency = endTime - runData.startTime;\n\n    // Update run data\n    runData.endTime = endTime;\n    runData.status = \"complete\";\n\n    // Send event\n    const event: ToolEndEvent = {\n      eventId: uuidv4(),\n      traceId: this.traceId,\n      runId,\n      parentRunId: runData.parentRunId,\n      timestamp: endTime,\n      type: \"tool_end\",\n      toolName: runData.data.toolName,\n      output,\n      latency\n    };\n\n    await this.client.sendEvent(event);\n  }\n\n  /**\n   * Called when chain starts running\n   */\n  async handleChainStart(\n    chain: Serialized,\n    inputs: Record<string, any>,\n    runId: string,\n    parentRunId?: string,\n    tags?: string[],\n    metadata?: Record<string, any>\n  ): Promise<void> {\n    const serialized = EventSerializer.serializeSerialized(chain);\n    const chainName = serialized.name;\n\n    // Store run data\n    this.runDataMap.set(runId, {\n      runId,\n      parentRunId,\n      nodeType: \"chain\",\n      startTime: Date.now(),\n      status: \"running\",\n      data: {\n        chainName,\n        inputs\n      }\n    });\n\n    // Send event\n    const event: ChainStartEvent = {\n      eventId: uuidv4(),\n      traceId: this.traceId,\n      runId,\n      parentRunId,\n      timestamp: Date.now(),\n      type: \"chain_start\",\n      chainName,\n      inputs,\n      metadata: {\n        ...this.config.metadata,\n        ...metadata,\n        tags\n      }\n    };\n\n    await this.client.sendEvent(event);\n  }\n\n  /**\n   * Called when chain ends running\n   */\n  async handleChainEnd(\n    outputs: Record<string, any>,\n    runId: string\n  ): Promise<void> {\n    const runData = this.runDataMap.get(runId);\n    if (!runData) {\n      console.error(`[AgentTrace] No run data found for ${runId}`);\n      return;\n    }\n\n    const endTime = Date.now();\n    const latency = endTime - runData.startTime;\n\n    // Update run data\n    runData.endTime = endTime;\n    runData.status = \"complete\";\n\n    // Send event\n    const event: ChainEndEvent = {\n      eventId: uuidv4(),\n      traceId: this.traceId,\n      runId,\n      parentRunId: runData.parentRunId,\n      timestamp: endTime,\n      type: \"chain_end\",\n      chainName: runData.data.chainName,\n      outputs,\n      latency\n    };\n\n    this.client.sendEvent(event);\n  }\n\n  /**\n   * Called when an error occurs\n   */\n  async handleLLMError(error: Error, runId: string): Promise<void> {\n    await this.handleError(error, runId);\n  }\n\n  async handleToolError(error: Error, runId: string): Promise<void> {\n    await this.handleError(error, runId);\n  }\n\n  async handleChainError(error: Error, runId: string): Promise<void> {\n    await this.handleError(error, runId);\n  }\n\n  private async handleError(error: Error, runId: string): Promise<void> {\n    const runData = this.runDataMap.get(runId);\n\n    if (runData) {\n      runData.status = \"error\";\n    }\n\n    const { message, stack } = EventSerializer.serializeError(error);\n\n    const event: ErrorEvent = {\n      eventId: uuidv4(),\n      traceId: this.traceId,\n      runId,\n      parentRunId: runData?.parentRunId,\n      timestamp: Date.now(),\n      type: \"error\",\n      error: message,\n      stack\n    };\n\n    await this.client.sendEvent(event);\n  }\n\n  /**\n   * Get trace ID\n   */\n  public getTraceId(): string {\n    return this.traceId;\n  }\n\n  /**\n   * Check if connected to backend\n   */\n  public isConnected(): boolean {\n    return this.client.isConnected();\n  }\n\n  /**\n   * Cleanup and disconnect\n   */\n  public async cleanup(): Promise<void> {\n    this.client.disconnect();\n    this.runDataMap.clear();\n  }\n}\n","/**\n * Public API exports\n */\nimport { TracingCallbackHandler } from \"./callback\";\nimport type { TraceConfig } from \"./types\";\n\n// Export classes (so users can import them)\nexport { TracingCallbackHandler } from \"./callback\";\nexport { TraceClient } from \"./client\";\nexport { EventSerializer } from \"./serializer\";\n\nexport type {\n  TraceConfig,\n  TraceEvent,\n  LLMStartEvent,\n  LLMEndEvent,\n  ToolStartEvent,\n  ToolEndEvent,\n  ChainStartEvent,\n  ChainEndEvent,\n  ErrorEvent,\n  NodeType,\n  NodeStatus,\n  RunData\n} from \"./types\";\n\n/**\n * Convenience function to create a tracer\n */\nexport function createTracer(config?: Partial<TraceConfig>) {\n  return new TracingCallbackHandler(config);\n}\n"],"names":["camelcaseModule","uuidv4"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}